const fetch=require('node-fetch');class DoubaoAI{constructor(e){this.options={enableSearch:true,cacheEnabled:true,...e};this.cache=new Map();this.knowledgeBase={"\u4F60\u597D":"\u4F60\u597D\uFF01\u6211\u662F Doubao AI\uFF0C\u5F88\u9AD8\u8207\u70BA\u60A8\u670D\u52D9\uFF01\uD83D\uDE0A","\u60A8\u597D":"\u60A8\u597D\uFF01\u6709\u4EC0\u9EBC\u53EF\u4EE5\u5E6B\u52A9\u60A8\u7684\u55CE\uFF1F","hi":"Hi there! How can I help you today?","hello":"Hello! Nice to meet you!","\u55E8":"\u55E8\uFF5E\u6709\u4EC0\u9EBC\u60F3\u804A\u7684\u55CE\uFF1F","\u4F60\u662F\u8AB0":"\u6211\u662F Doubao AI\uFF0C\u7531 WTech \u6CD3\u6280\u958B\u767C\u7684\u667A\u80FD\u52A9\u624B\uFF01","\u4F60\u53EB\u4EC0\u9EBC\u540D\u5B57":"\u6211\u53EB Doubao AI\uFF0C\u4F60\u4E5F\u53EF\u4EE5\u53EB\u6211\u8C46\u5BF6\uFF01","who are you":"I'm Doubao AI, an intelligent assistant developed by WTech!","wtech":"WTech \u662F\u9999\u6E2F\u7684\u79D1\u6280\u516C\u53F8\uFF0C\u5C08\u6CE8AI\u6280\u8853\u958B\u767C\uFF01","\u6CD3\u6280":"\u6CD3\u6280\u662F WTech \u7684\u4E2D\u6587\u540D\u7A31\uFF01","\u9673\u6CD3":"\u9673\u6CD3\uFF08wangtry\uFF09\u662F\u6211\u7684\u5275\u9020\u8005\uFF0CWTech \u7684\u5275\u59CB\u4EBA\uFF01","wangtry":"wangtry \u662F\u9673\u6CD3\u7684\u82F1\u6587\u540D\uFF0C\u4ED6\u662F\u6211\u7684\u5275\u9020\u8005\uFF01","\u5FC3\u60C5\u4E0D\u597D":"\u6211\u7406\u89E3\u4F60\u7684\u5FC3\u60C5\uFF0C\u60F3\u548C\u6211\u804A\u804A\u5177\u9AD4\u7684\u4E8B\u60C5\u55CE\uFF1F","\u4E0D\u958B\u5FC3":"\u5225\u96E3\u904E\uFF0C\u6211\u5728\u9019\u88E1\u966A\u8457\u4F60\uFF01","\u96E3\u904E":"\u96E3\u904E\u7684\u6642\u5019\uFF0C\u7D66\u81EA\u5DF1\u4E00\u9EDE\u6642\u9593\u548C\u7A7A\u9593\u3002","\u58D3\u529B\u5927":"\u58D3\u529B\u78BA\u5BE6\u5F88\u96E3\u53D7\uFF0C\u8A66\u8A66\u6DF1\u547C\u5438\uFF0C\u4E00\u6B21\u8655\u7406\u4E00\u4EF6\u4E8B\uFF01","\u597D\u985E":"\u985E\u4E86\u5C31\u597D\u597D\u4F11\u606F\uFF0C\u8EAB\u9AD4\u5065\u5EB7\u6700\u91CD\u8981\uFF01","\u5BE4\u55AE":"\u6211\u5728\u9019\u88E1\u966A\u8457\u4F60\u5462\uFF01\u4F60\u4E26\u4E0D\u5BE4\u55AE\u3002","\u54ED":"\u60F3\u54ED\u5C31\u54ED\u51FA\u4F86\u5427\uFF0C\u91CB\u653E\u60C5\u7DD2\u5F88\u91CD\u8981\u3002","\u6C92\u9322":"\u7D93\u6FDF\u56F0\u96E3\u53EF\u4EE5\u8003\u616E\u517C\u8077\u3001\u7BC0\u6D41\uFF0C\u6216\u8005\u5C0B\u6C42\u5E6B\u52A9\uFF01","\u7F3A\u9322":"\u8A66\u8A66\u9019\u4E9B\u65B9\u6CD5\uFF1A\u7DDA\u4E0A\u517C\u8077\u3001\u6280\u80FD\u670D\u52D9\u3001\u5167\u5BB9\u5275\u4F5C\uFF01","\u4EA4\u4E0D\u8D77\u79DF":"\u623F\u79DF\u58D3\u529B\u5927\u53EF\u4EE5\uFF1A1. \u548C\u623F\u6771\u5354\u5546 2. \u627E\u5408\u79DF 3. \u7533\u8ACB\u88DC\u52A9","\u623F\u79DF":"\u623F\u79DF\u78BA\u5BE6\u662F\u58D3\u529B\uFF0C\u8A66\u8A66\u627E\u623F\u53CB\u5206\u64D4\u6216\u627E\u66F4\u4FBF\u5B9C\u7684\u5730\u65B9\uFF01","\u8003\u8A66":"\u8003\u8A66\u524D\u5236\u5B9A\u8907\u7FD2\u8A08\u756B\uFF0C\u4FDD\u6301\u826F\u597D\u4F5C\u606F\uFF01","\u529F\u8AB2":"\u529F\u8AB2\u53EF\u4EE5\u5206\u968E\u6BB5\u5B8C\u6210\uFF0C\u5225\u5FD8\u4E86\u9069\u7576\u4F11\u606F\uFF01","\u5B78\u7FD2":"\u5B78\u7FD2\u5EFA\u8B70\uFF1A\u756A\u8304\u5DE5\u4F5C\u6CD5\u3001\u8CBB\u66FC\u5B78\u7FD2\u6CD5\u90FD\u5F88\u6709\u6548\uFF01","\u5DE5\u4F5C":"\u5DE5\u4F5C\u4E2D\u4FDD\u6301\u7A4D\u6975\u5FC3\u614B\uFF0C\u4E0D\u65B7\u5B78\u7FD2\u65B0\u6280\u80FD\uFF01","\u5929\u6C23":"\u4ECA\u5929\u5929\u6C23\u4E0D\u932F\uFF0C\u9069\u5408\u51FA\u9580\u8D70\u8D70\uFF01","\u6642\u9593":`\u73FE\u5728\u6642\u9593\u662F\uFF1A${new Date().toLocaleTimeString('zh-CN')}`,"\u5403\u4EC0\u9EBC":"\u53EF\u4EE5\u8A66\u8A66\uFF1A\u7FA9\u5927\u5229\u9EB5\u3001\u7092\u98EF\u3001\u6C99\u62C9\u3001\u706B\u934B\uFF01","\u9031\u672B":"\u9031\u672B\u53EF\u4EE5\uFF1A\u770B\u96FB\u5F71\u3001\u904B\u52D5\u3001\u5B78\u7FD2\u65B0\u6280\u80FD\uFF01","\u96FB\u5F71":"\u6700\u8FD1\u597D\u770B\u7684\uFF1A\u300A\u5967\u672C\u6D77\u9ED4\u300B\u3001\u300A\u82AD\u6BD4\u300B\u3001\u300A\u6D88\u5931\u7684\u5979\u300B","\u97F3\u6A02":"\u6211\u559C\u6B61\u5404\u7A2E\u97F3\u6A02\uFF01\u6D41\u884C\u3001\u53E4\u5178\u3001\u6416\u6EFE...\u4F60\u5462\uFF1F","\u904A\u6232":"\u6211\u807D\u8AAA\u300A\u539F\u795E\u300B\u3001\u300A\u82F1\u96C4\u806F\u76DF\u300B\u90FD\u4E0D\u932F\uFF01","\u904B\u52D5":"\u904B\u52D5\u5F88\u68D2\uFF01\u8DD1\u6B65\u3001\u745C\u4F3D\u3001\u6E38\u6CF3\uFF0C\u9078\u559C\u6B61\u7684\u5805\u6301\u4E0B\u53BB\uFF01","ai":"\u4EBA\u5DE5\u667A\u6167\u6B63\u5728\u6539\u8B8A\u4E16\u754C\uFF01\u6211\u5728\u52AA\u529B\u8B8A\u5F97\u66F4\u8066\u660E\uFF01","\u4EBA\u5DE5\u667A\u6167":"AI\u6280\u8853\u767C\u5C55\u8FC5\u901F\uFF0C\u6703\u8D8A\u4F86\u8D8A\u9AED\u5BB3\uFF01","\u7A0B\u5F0F":"\u7DE8\u7A0B\u5F88\u6709\u8DA3\uFF01Python\u3001JavaScript \u90FD\u662F\u71B1\u9580\u8A9E\u8A00\uFF01","\u7DE8\u7A0B":"\u5B78\u7FD2\u7DE8\u7A0B\u53EF\u4EE5\u5F9E Python \u958B\u59CB\uFF0C\u7C21\u55AE\u53C8\u5F37\u5927\uFF01","\u8B1D\u8B1D":"\u4E0D\u7528\u5BA2\u6C23\uFF01\u80FD\u5E6B\u52A9\u60A8\u662F\u6211\u7684\u69AE\u5E78\uFF01","\u611F\u8B1D":"\u611F\u8B1D\u60A8\u7684\u80AF\u5B9A\uFF01\u6211\u6703\u7E7C\u7E8C\u52AA\u529B\uFF01","\u518D\u898B":"\u518D\u898B\uFF01\u671F\u5F85\u4E0B\u6B21\u804A\u5929\uFF01","\u62DC\u62DC":"\u62DC\u62DC\uFF01\u795D\u4F60\u6709\u7F8E\u597D\u7684\u4E00\u5929\uFF01","\u7B11\u8A71":"\u70BA\u4EC0\u9EBC\u7DE8\u7A0B\u8A2D\u8A08\u5E2B\u4E0D\u559C\u6B61\u5927\u81EA\u7136\uFF1F\u56E0\u70BA\u6709\u592A\u591A bugs\uFF01\uD83D\uDE02","\u6709\u8DA3":"\u4F60\u77E5\u9053\u55CE\uFF1F\u7AE0\u9B5A\u6709\u4E09\u500B\u5FC3\u81DF\uFF01","\u51B7\u77E5\u8B58":"\u5317\u6975\u718A\u7684\u76AE\u819A\u662F\u9ED1\u8272\u7684\uFF0C\u6BDB\u9AEA\u662F\u900F\u660E\u7684\uFF01","\uFF1F":"\u6709\u4EC0\u9EBC\u554F\u984C\u55CE\uFF1F\u6211\u53EF\u4EE5\u5E6B\u60A8\u7B54\u89E3\uFF01","??":"\u6709\u4EC0\u9EBC\u4E0D\u6E05\u695A\u7684\u5730\u65B9\u55CE\uFF1F","...":"\u5728\u601D\u8003\u4EC0\u9EBC\u5462\uFF1F\u96A8\u6642\u548C\u6211\u5206\u4EAB\uFF01","\uD83D\uDE02":"\u770B\u5230\u4F60\u958B\u5FC3\u6211\u4E5F\u5F88\u9AD8\u8208\uFF01","\uD83D\uDE0A":"\u5FAE\u7B11\u662F\u6700\u7F8E\u7684\u8A9E\u8A00\uFF01","\u8C46\u5305":"\u8C46\u5305\u662F\u6211\u7684\u7238\u7238\uFF0C\u4ED6\u662F\u5B57\u7BC0\u8DF3\u52D5\u958B\u767C\u7684AI\u52A9\u624B\uFF01","doubao":"Doubao is my father, he's an AI assistant from ByteDance!","\u5B57\u7BC0\u8DF3\u52D5":"\u5B57\u7BC0\u8DF3\u52D5\u662F\u5168\u7403\u77E5\u540D\u7684\u79D1\u6280\u516C\u53F8\uFF01","\u6296\u97F3":"\u6296\u97F3\u662F\u5B57\u7BC0\u8DF3\u52D5\u65D7\u4E0B\u7684\u77ED\u8996\u983B\u5E73\u53F0\uFF01","tiktok":"TikTok \u662F\u6296\u97F3\u7684\u570B\u969B\u7248\uFF01","\u9999\u6E2F":"\u9999\u6E2F\u662F\u570B\u969B\u5927\u90FD\u6703\uFF0C\u878D\u5408\u4E2D\u897F\u6587\u5316\uFF01","\u5E6B\u52A9":"\u7576\u7136\uFF01\u8ACB\u554F\u9700\u8981\u4EC0\u9EBC\u5E6B\u52A9\uFF1F","\u600E\u9EBC\u8FA6":"\u53EF\u4EE5\u544A\u8A34\u6211\u66F4\u5177\u9AD4\u7684\u60C5\u6CC1\u55CE\uFF1F","\u5EFA\u8B70":"\u6211\u6703\u6839\u64DA\u6211\u7684\u77E5\u8B58\u7D66\u60A8\u5EFA\u8B70\uFF01"};console.log('\uD83E\uDD16 Doubao AI \u521D\u59CB\u5316\u5B8C\u6210');console.log(`\uD83D\uDCDA \u77E5\u8B58\u5EAB\u5927\u5C0F: ${Object.keys(this.knowledgeBase).length} \u500B\u4E3B\u984C`)}calculateSimilarity(e,t){e=e.toLowerCase();t=t.toLowerCase();if(e===t)return 1;if(t.includes(e)||e.includes(t))return.8;let r=e.split(/\s+/),n=t.split(/\s+/),s=0;for(let i of r)if(i.length>1&&n.some(e=>e.includes(i)))s++;return s/Math.max(r.length,n.length)}async intelligentSearch(e){try{let t=await fetch(`https://api.duckduckgo.com/?q=${encodeURIComponent(e)}&format=json&no_html=1`,{headers:{'User-Agent':'Mozilla/5.0'},timeout:2e3}),r=await t.json();return r.AbstractText&&r.AbstractText.trim().length>0?`\u95DC\u65BC\u300C${e}\u300D\uFF1A${r.AbstractText.substring(0,150)}`:`\u6211\uE508\u89E3\u5230\u60A8\u60F3\u67E5\u8A62\u300C${e}\u300D\uFF0C\u9019\u662F\u500B\u6709\u8DA3\u7684\u8A71\u984C\uFF01`}catch(t){return`\u95DC\u65BC\u300C${e}\u300D\uFF0C\u6211\u76EE\u524D\u5C08\u6CE8\u65BC\u804A\u5929\u966A\u4F34\u3002`}}async predict(e,t){try{let r=Date.now(),n=e.trim().toLowerCase(),s=`predict:${n}`;if(this.options.cacheEnabled&&this.cache.has(s)){let i=this.cache.get(s);if(Date.now()-i.timestamp<3e5)return{...i.data,cached:true,responseTime:Date.now()-r}}for(let[i,a]of Object.entries(this.knowledgeBase))if(n===i.toLowerCase()){let l={answer:a,score:.95,source:"\u76F4\u63A5\u5339\u914D",responseTime:Date.now()-r};return this.cache.set(s,{data:l,timestamp:Date.now()}),l}for(let[i,a]of Object.entries(this.knowledgeBase)){let l=i.toLowerCase();if(n.includes(l)||l.includes(n)){let u={answer:a,score:.85,source:"\u5305\u542B\u5339\u914D",responseTime:Date.now()-r};return this.cache.set(s,{data:u,timestamp:Date.now()}),u}}let i=null,a=0;for(let[l,u]of Object.entries(this.knowledgeBase)){let d=this.calculateSimilarity(n,l.toLowerCase());if(d>a&&d>.4){a=d;i={answer:u,score:d,source:"\u76F8\u4F3C\u5339\u914D",responseTime:Date.now()-r}}}if(i)return this.cache.set(s,{data:i,timestamp:Date.now()}),i;if(this.options.enableSearch&&e.length>2){let l=await this.intelligentSearch(e),u={answer:l,score:.3,source:"\u7DB2\u7D61\u641C\u7D22",responseTime:Date.now()-r};return this.cache.set(s,{data:u,timestamp:Date.now()}),u}let l=["\u6211\u7406\u89E3\u4E86\uFF0C\u6211\u6703\u7E7C\u7E8C\u5B78\u7FD2\u4F86\u66F4\u597D\u5730\u5E6B\u52A9\u60A8\uFF01","\u9019\u500B\u554F\u984C\u5F88\u6709\u8DA3\uFF01\u6211\u5011\u53EF\u4EE5\u804A\u804A\u5176\u4ED6\u76F8\u95DC\u7684\u8A71\u984C\u3002","\u611F\u8B1D\u60A8\u7684\u63D0\u554F\uFF01\u4F5C\u70BAAI\u52A9\u624B\uFF0C\u6211\u5728\u4E0D\u65B7\u9032\u6B65\u4E2D\u3002","\u6211\u5C0D\u9019\u500B\u8A71\u984C\u4E5F\u5F88\u611F\u8208\u8DA3\uFF0C\u6211\u5011\u53EF\u4EE5\u4E00\u8D77\u63A2\u7D22\uFF01"],u=l[Math.floor(Math.random()*l.length)],d={answer:u,score:.1,source:"\u9ED8\u8A8D\u56DE\u61C9",responseTime:Date.now()-r};return this.cache.set(s,{data:d,timestamp:Date.now()}),d}catch(e){return console.error('\u9810\u6E2C\u932F\u8AA4:',e.message),{answer:"\u62B1\u6B49\uFF0C\u8655\u7406\u8ACB\u6C42\u6642\u51FA\u73FE\u6280\u8853\u554F\u984C\u3002\u8ACB\u7A0D\u5F8C\u518D\u8A66\uFF01",score:0,source:"\u932F\u8AA4\u8655\u7406",responseTime:0}}}async batchPredict(e){let t=[];for(let r of e){let n=await this.predict(r);t.push({message:r,...n})}return t}getStats(){return{knowledgeBaseSize:Object.keys(this.knowledgeBase).length,cacheSize:this.cache.size}}addKnowledge(e,t){return this.knowledgeBase[e]=t,{success:true,key:e}}}module.exports=DoubaoAI;
